<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<!-- For wss -->
		<meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' wss://localhost;">
		<!-- end for wss -->
		<title>transCendenZ</title>
		<link rel="icon" href="favicon.gif?v=2" type="image/gif"/>

		<script type="text/javascript">
			const ws = new WebSocket('wss://localhost/wss/');
			ws.onopen = () => console.log("Connected!");
			ws.onmessage = (msg) => console.log("Got:", msg.data);
		</script>


		<!-- <script src="profile.js" defer></script>
		<script src="pong.js" defer></script> -->
	</head>
	<body>
		<header>
			<h1>Pong Game</h1>
			<p>Welcome to the game!</p>
		</header>
	
		<hr>
		
		<main>
			<noscript>
			<p>Sorry, this website requires JavaScript to function. Please enable JavaScript in your browser settings to continue.</p>
			</noscript>

			<div id="login" hidden>
				<p>Please, log in to play the game.</p>
				<button onclick=loginWith42(event)>Log in with 42</button>
				<p>---or---</p>
				<form id="loginForm" method="POST" onsubmit=handleLogin(event)>
					<div>
						<label for="newUsername">Enter your username:</label>
						<input  type="username"
								id="username"
								placeholder="username"
								minlength="3"
								maxlength="20"
								pattern="[a-zA-Z0-9_]+"
								title="Username can only contain letters, numbers, and underscores, and must be 3-20 characters long."
								required/>
					</div>
					<div>
						<label for="password">Enter your password:</label>
						<input type="password"
								id="password"
								placeholder="********"
								required/>
					</div>
					<button type="submit">Log in</button>
				</form>
				<p id="loginResult"></p>
				<div>
					<p style="display: inline;">Don't have an account?</p>
					<button style="display: inline;" onclick=startAccountCreation()>Create account</button>
				</div>
			</div>
				
			<div id="accountCreation" hidden>
				<div id="accountCreationHeader">
					<p>Please, create your account to play the game.</p>
					<button onclick=signUpWith42(event)>Sign up with GMail</button>
					<p>---or---</p>
				</div>
				<form id="accountCreationForm" method="POST" onsubmit=handleAccountCreation(event)>
					<div>
						<label for="newUsername">Enter your username:</label>
						<input  type="username"
								id="newUsername"
								placeholder="username"
								minlength="3"
								maxlength="20"
								pattern="[a-zA-Z0-9_]+"
								title="Username can only contain letters, numbers, and underscores, and must be 3-20 characters long."
								required/>
					</div>
					<div>
						<label for="newEmail">Enter your email:</label>
						<input type="email"
								id="newEmail"
								placeholder="username@email.com"
								required
								pattern="[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}"
								title="user@email.com"/>
					</div>
					<div>
						<label for="newPassword">Enter your password:</label>
						<input  type="password"
								id="newPassword"
								placeholder="********"
								minlength="8"
								pattern="^(?!\d+$).*$"
								required/>
					</div>
					<button type="submit">Create account</button>
				</form>
				<p id="accountCreationResult"></p>
				<div>
					<p style="display: inline;">Already have an account?</p>
					<button style="display: inline;" onclick=startLogin()>Log in</button>
				</div>
			</div>
			
			<div id="userProfile" hidden>
				<p>You have just successfully logged in to your account!</p>
				<p id="profileInformation"></p>
				<button onclick=startGame()>Play Pong</button>
				<button onclick=logOut()>Log out</button>
			</div>

			<div id="game" hidden>
    			<h1>Pong Game 1v1</h1>
    			<canvas id="pongCanvas" width="600" height="400"></canvas>
  				<p>Use W and S for Player 1 (left) and Arrow keys for Player 2 (right)</p>
				<button onclick=endGame()>End game</button>
			</div>

		</main>
	
		<hr>
	
		<footer>
			<p>Â© 2025 All rights reserved</p>
		</footer>
	</body>
</html>
